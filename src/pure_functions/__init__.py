"""
Pure function implementations for better testability
"""