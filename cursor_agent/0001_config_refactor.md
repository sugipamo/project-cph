# 設定ファイルリファクタリング調査報告書

## 現状分析

### 設定ファイルの構造
1. 新しい設定システム（`src/config/mod.rs`）
   - 環境変数展開機能
   - エイリアス管理機能
   - 型安全な設定値アクセス
   - エラー処理の改善

2. 旧設定システム（`src/config_old/`）
   - 分散した設定ファイル
   - 個別の設定管理クラス
   - 重複したエイリアス管理

### 主な課題
1. 設定ファイルの重複
   - 新旧システムで同様の設定が存在
   - エイリアス管理が複数箇所に分散

2. 型安全性の不一致
   - 新システムは型安全な実装
   - 旧システムは部分的に型安全性が欠如

3. エラー処理の不統一
   - 新システムは詳細なエラー型を定義
   - 旧システムは基本的なエラー処理のみ

## リファクタリング方針

### 優先度：高
1. 設定ファイルの統合
   - `config.yaml`への一元化
   - 環境変数展開の統一的な適用

2. エイリアス管理の統合
   - `AliasSection`の活用
   - 重複排除と一貫性の確保

### 優先度：中
1. 型安全性の向上
   - `TypedValue`トレイトの活用
   - 静的型チェックの強化

2. エラー処理の統一
   - `ConfigError`の活用
   - エラーメッセージの日本語化

### 優先度：低
1. テストカバレッジの向上
   - 環境変数展開のテスト強化
   - エッジケースの考慮

## 作業難易度

1. 設定ファイル統合: 🔴 高
   - 既存コードへの影響大
   - 移行作業が必要

2. エイリアス管理統合: 🟡 中
   - 既存機能の移行
   - インターフェース変更minimal

3. 型安全性向上: 🟢 低
   - 既存コードの修正minimal
   - 段階的な適用可能

## 次のステップ

1. 設定ファイルの統合計画の作成
2. 既存コードの依存関係の整理
3. テストケースの準備
4. 段階的なリファクタリングの実施 