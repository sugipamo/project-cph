/home/cphelper/.local/lib/python3.12/site-packages/pytest_asyncio/plugin.py:217: PytestDeprecationWarning: The configuration option "asyncio_default_fixture_loop_scope" is unset.
The event loop scope for asynchronous fixtures will default to the fixture caching scope. Future versions of pytest-asyncio will default the loop scope for asynchronous fixtures to function scope. Set the default fixture loop scope explicitly in order to avoid unexpected behavior in the future. Valid fixture loop scopes are: "function", "class", "module", "package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_SCOPE_UNSET))
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-8.3.5, pluggy-1.5.0
rootdir: /home/cphelper/project-cph
configfile: pytest.ini
plugins: asyncio-0.26.0, cov-6.1.1
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 493 items

tests/cli/test_cph_sh.py ssssssssss                                      [  2%]
tests/context/test_docker_naming_integration.py ...                      [  2%]
tests/context/test_user_input_parser.py ..........                       [  4%]
tests/context/test_validation_utils.py ........                          [  6%]
tests/di_factory/test_base_composite_request.py ......                   [  7%]
tests/di_factory/test_di_container.py ..                                 [  7%]
tests/docker/test_docker_file_handler.py sssssssssss                     [ 10%]
tests/docker/test_docker_file_request.py ...                             [ 10%]
tests/docker/test_docker_request_result.py ...                           [ 11%]
tests/docker/test_docker_utils.py ......                                 [ 12%]
tests/execution_context/test_config_resolver.py ........................ [ 17%]
....................                                                     [ 21%]
tests/factory/test_driver_factory.py .........                           [ 23%]
tests/file/test_file_request.py ....                                     [ 24%]
tests/file/test_local_file_driver.py .......                             [ 25%]
tests/file/test_local_file_handler.py ssssssss                           [ 27%]
tests/fitting/test_docker_state_manager.py ...........................   [ 32%]
tests/fitting/test_environment_inspector.py ..........                   [ 34%]
tests/fitting/test_preparation_executor.py ..........................    [ 39%]
tests/integration/test_command_line_parsing.py ......                    [ 41%]
tests/mock/test_dummy_file_driver.py ......                              [ 42%]
tests/mock/test_mock_file_driver.py ..........                           [ 44%]
tests/performance/test_caching.py ................                       [ 47%]
tests/python/test_python_request.py .........                            [ 49%]
tests/python/test_python_utils.py ....                                   [ 50%]
tests/resource/test_docker_naming.py ssssssssss                          [ 52%]
tests/resource/test_docker_run_handler.py ss                             [ 52%]
tests/resource/test_file_driver.py ............                          [ 55%]
tests/resource/test_file_handler.py ssssssssssssssssssss                 [ 59%]
tests/resource/test_run_handler.py ss                                    [ 59%]
tests/result/test_docker_result.py ..                                    [ 60%]
tests/result/test_file_result.py ..                                      [ 60%]
tests/result/test_result.py ...                                          [ 61%]
tests/result/test_shell_result.py ..                                     [ 61%]
tests/shell/test_shell_interactive_request.py ....                       [ 62%]
tests/shell/test_shell_request.py ..........                             [ 64%]
tests/step_generation/test_dependency.py .............                   [ 66%]
tests/unit/test_docker_naming_utils.py ...................               [ 70%]
tests/unit/test_format_utils.py .........                                [ 72%]
tests/unit/test_process_utils.py .................                       [ 76%]
tests/unit/test_pure_functions.py ...................................... [ 83%]
.........                                                                [ 85%]
tests/unit/test_unified_driver.py ...........                            [ 87%]
tests/unit/test_validation.py ....................................       [ 95%]
tests_slow/test_docker_driver.py ...............F...                     [ 98%]
tests_slow/test_shell_utils.py .....                                     [100%]

=================================== FAILURES ===================================
______________________ test_localdockerdriver_build_stdin ______________________

    def test_localdockerdriver_build_stdin():
        """
        LocalDockerDriver.build() で dockerfile_text を渡した場合、
        ShellUtil.run_subprocess の inputdata に正しく渡るかをテスト
        """
        from src.operations.docker.docker_driver import LocalDockerDriver
        from src.operations.shell import shell_utils
        # ShellUtil.run_subprocessを一時的に差し替え
>       orig_run_subprocess = shell_utils.ShellUtil.run_subprocess
E       AttributeError: module 'src.operations.shell.shell_utils' has no attribute 'ShellUtil'. Did you mean: 'ShellUtils'?

tests_slow/test_docker_driver.py:171: AttributeError
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.3-final-0 ________________

Name                                                           Stmts   Miss  Cover
----------------------------------------------------------------------------------
src/__init__.py                                                    0      0   100%
src/context/__init__.py                                            2      0   100%
src/context/config_resolver_proxy.py                              28     11    61%
src/context/context_validator.py                                  15      8    47%
src/context/dockerfile_resolver.py                                53     37    30%
src/context/execution_context.py                                 129     49    62%
src/context/execution_data.py                                     12      0   100%
src/context/parsers/__init__.py                                    0      0   100%
src/context/parsers/input_parser.py                               55      4    93%
src/context/parsers/system_info_manager.py                        23     17    26%
src/context/parsers/validation_service.py                         41     33    20%
src/context/resolver/config_node.py                               19      4    79%
src/context/resolver/config_node_logic.py                         45      2    96%
src/context/resolver/config_resolver.py                          127     64    50%
src/context/user_input_parser.py                                  76      4    95%
src/context/utils/__init__.py                                      3      0   100%
src/context/utils/format_utils.py                                 41     20    51%
src/context/utils/validation_utils.py                             32      2    94%
src/env/__init__.py                                               12     12     0%
src/env/build_operations.py                                       53     53     0%
src/env/step/__init__.py                                           2      2     0%
src/env/step/run_step_base.py                                     15     15     0%
src/env/step/run_step_build.py                                     8      8     0%
src/env/step/run_step_copy.py                                     14     14     0%
src/env/step/run_step_factory.py                                  15     15     0%
src/env/step/run_step_mkdir.py                                    11     11     0%
src/env/step/run_step_move.py                                     14     14     0%
src/env/step/run_step_movetree.py                                 14     14     0%
src/env/step/run_step_oj.py                                       13     13     0%
src/env/step/run_step_python.py                                   11     11     0%
src/env/step/run_step_registry.py                                  8      8     0%
src/env/step/run_step_remove.py                                   11     11     0%
src/env/step/run_step_rmtree.py                                   11     11     0%
src/env/step/run_step_shell.py                                    11     11     0%
src/env/step/run_step_touch.py                                    11     11     0%
src/env/step/run_steps.py                                         19     19     0%
src/env_core/__init__.py                                           3      0   100%
src/env_core/step/__init__.py                                      6      0   100%
src/env_core/step/core.py                                         86     78     9%
src/env_core/step/dependency.py                                  102     15    85%
src/env_core/step/request_converter.py                           114     94    18%
src/env_core/step/step.py                                         81     19    77%
src/env_core/step/workflow.py                                     53     42    21%
src/env_core/workflow/__init__.py                                  4      0   100%
src/env_core/workflow/graph_based_workflow_builder.py            189    163    14%
src/env_core/workflow/graph_to_composite_adapter.py              105     90    14%
src/env_core/workflow/pure_request_factory.py                    235    235     0%
src/env_core/workflow/request_execution_graph.py                 347    296    15%
src/env_integration/fitting/__init__.py                            3      0   100%
src/env_integration/fitting/docker_state_manager.py              104      5    95%
src/env_integration/fitting/environment_inspector.py             180     59    67%
src/env_integration/fitting/preparation_error_handler.py         128     79    38%
src/env_integration/fitting/preparation_executor.py              255     52    80%
src/main.py                                                      108    108     0%
src/operations/__init__.py                                        42     16    62%
src/operations/base_request.py                                    34      4    88%
src/operations/composite/__init__.py                              12      2    83%
src/operations/composite/base_composite_request.py                36      2    94%
src/operations/composite/composite_request.py                     45     27    40%
src/operations/composite/composite_structure.py                   30     20    33%
src/operations/composite/driver_bound_request.py                  17      9    47%
src/operations/composite/execution_controller.py                  13      9    31%
src/operations/composite/output_manager.py                        16     11    31%
src/operations/composite/parallel_composite_request.py            23     16    30%
src/operations/composite/unified_driver.py                        53     18    66%
src/operations/constants/__init__.py                               2      0   100%
src/operations/constants/operation_type.py                         8      0   100%
src/operations/di_container.py                                    25      6    76%
src/operations/docker/__init__.py                                  4      0   100%
src/operations/docker/docker_driver.py                           122     18    85%
src/operations/docker/docker_file_request.py                      31      6    81%
src/operations/docker/docker_request.py                           90     36    60%
src/operations/docker/docker_utils.py                             19      0   100%
src/operations/exceptions/composite_step_failure.py                5      3    40%
src/operations/factory/__init__.py                                 0      0   100%
src/operations/factory/driver_factory.py                          96     43    55%
src/operations/file/__init__.py                                   10      1    90%
src/operations/file/file_driver.py                               113     42    63%
src/operations/file/file_op_type.py                               12      0   100%
src/operations/file/file_request.py                               43      4    91%
src/operations/file/local_file_driver.py                          42      3    93%
src/operations/file/strategies/__init__.py                         0      0   100%
src/operations/file/strategies/base_strategy.py                    9      1    89%
src/operations/file/strategies/file_operations_strategies.py      33     14    58%
src/operations/file/strategies/read_strategy.py                    6      0   100%
src/operations/file/strategies/strategy_factory.py                11      0   100%
src/operations/file/strategies/write_strategy.py                   6      0   100%
src/operations/mock/__init__.py                                   11      2    82%
src/operations/mock/dummy_docker_driver.py                        25      1    96%
src/operations/mock/dummy_file_driver.py                          31      0   100%
src/operations/mock/dummy_shell_driver.py                          9      6    33%
src/operations/mock/mock_docker_driver.py                         38      0   100%
src/operations/mock/mock_file_driver.py                          149     11    93%
src/operations/mock/mock_shell_driver.py                          33     22    33%
src/operations/mock/mock_shell_request.py                         95      6    94%
src/operations/python/__init__.py                                  2      0   100%
src/operations/python/python_request.py                           40      1    98%
src/operations/python/python_utils.py                             25      0   100%
src/operations/result/__init__.py                                  4      0   100%
src/operations/result/docker_result.py                            12      0   100%
src/operations/result/file_result.py                              12      0   100%
src/operations/result/result.py                                   54     10    81%
src/operations/result/shell_result.py                             12      0   100%
src/operations/shell/__init__.py                                   5      0   100%
src/operations/shell/local_shell_driver.py                         5      1    80%
src/operations/shell/shell_driver.py                               5      1    80%
src/operations/shell/shell_interactive_request.py                 88     67    24%
src/operations/shell/shell_request.py                             35      0   100%
src/operations/shell/shell_utils.py                               30      0   100%
src/operations/utils/__init__.py                                   0      0   100%
src/operations/utils/docker_naming.py                             20      0   100%
src/operations/utils/path_utils.py                                96     66    31%
src/operations/utils/process_utils.py                             90     18    80%
src/operations/utils/pure_functions.py                           167     12    93%
src/performance/__init__.py                                        2      0   100%
src/performance/caching.py                                       170     18    89%
src/utils/__init__.py                                              0      0   100%
src/utils/debug_logger.py                                        116     97    16%
src/utils/validation.py                                           71      0   100%
src/workflow_execution_service.py                                104    104     0%
----------------------------------------------------------------------------------
TOTAL                                                           5621   2597    54%
=========================== short test summary info ============================
FAILED tests_slow/test_docker_driver.py::test_localdockerdriver_build_stdin
================== 1 failed, 429 passed, 63 skipped in 19.88s ==================
