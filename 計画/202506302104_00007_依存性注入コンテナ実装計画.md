# 依存性注入コンテナ実装計画

## 概要
old_srcのDIContainerを参考に、Rustで型安全な依存性注入コンテナを実装する。

## 背景と目的
- old_srcではinfrastructure/di_container.pyで中央集権的な依存管理を実現
- DIKey列挙型による型安全なキー管理
- 遅延ロードによる起動時間の最適化
- Rustの型システムを活用してより安全で効率的な実装を目指す

## 実装方針
1. **DIコンテナの基本設計**
   - ジェネリクスを活用した型安全な実装
   - ライフタイムを考慮した参照管理
   - Arc<dyn Trait>による共有可能な依存性
   
2. **依存性の登録と解決**
   - ビルダーパターンによる流暢なAPI
   - 循環依存の検出機構
   - 遅延初期化のサポート

3. **スコープ管理**
   - シングルトンスコープ
   - リクエストスコープ
   - トランジェントスコープ

4. **型安全性の強化**
   - PhantomDataを使用した型レベルのキー管理
   - コンパイル時の依存性チェック

## 期待される効果
- 依存性の一元管理
- テスト時のモック注入が容易
- 起動時間の最適化
- 実行時エラーの削減

## 実装優先度
中（基盤機能だが、現在の簡易的な実装でも動作可能）

## 参考実装
- old_src/infrastructure/di_container.py
- old_src/cli/cli_app.py（DIコンテナの使用例）
- old_src/config/di_config.py