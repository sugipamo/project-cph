# テストカバレッジ向上計画

## 概要
テストカバレッジの現状を分析し、カバレッジツールの導入と向上策を計画する

## 現状分析
### テストの実行状況
- 全テスト成功: 48テスト（0失敗、0無視）
- テスト実行時間: 約15秒
- テストの分布:
  - ユニットテスト: 32件（lib.rs）
  - 統合テスト: 16件（複数のテストファイル）

### カバレッジツールの状況
- `cargo-tarpaulin`: 未インストール
- `grcov`: 未インストール
- カバレッジレポート: 未生成

## 実装計画

### フェーズ1: カバレッジツールの導入
1. **ツールの選定**
   - `cargo-tarpaulin`: Linux専用だがシンプル
   - `grcov` + `llvm-cov`: クロスプラットフォーム対応
   - 推奨: `grcov` (GitHub Actionsとの統合が容易)

2. **ローカル環境での設定**
   ```toml
   # .cargo/config.toml
   [build]
   rustflags = ["-Cinstrument-coverage"]
   ```

3. **カバレッジ生成スクリプト**
   ```bash
   # scripts/coverage.sh
   cargo clean
   cargo test
   grcov . -s . --binary-path ./target/debug/ -t html -o ./coverage/
   ```

### フェーズ2: カバレッジ分析と改善
1. **現在のテスト対象**
   - infrastructure層: 十分にカバー
   - application層: 部分的にカバー
   - domain層: 未確認

2. **カバレッジ向上の優先順位**
   - 高: ビジネスロジック（application/services）
   - 中: エラーハンドリングパス
   - 低: モックやテストサポートコード

### フェーズ3: CI/CD統合
1. **GitHub Actionsでの自動実行**
2. **カバレッジバッジの追加**
3. **PRでのカバレッジ変化の可視化**

## 目標設定
- 短期目標: カバレッジ測定環境の構築
- 中期目標: カバレッジ80%以上
- 長期目標: クリティカルパスの100%カバー

## 次のステップ
1. grcovのインストール手順の文書化
2. 初回カバレッジレポートの生成
3. カバレッジが低い領域の特定
4. テスト追加計画の策定