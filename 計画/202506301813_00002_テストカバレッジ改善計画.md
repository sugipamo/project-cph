# テストカバレッジ改善計画

## 概要
cargo tarpaulinによるカバレッジ測定結果: **72.35%** (157/217行)

## カバレッジ詳細分析

### 高カバレッジ (90%以上)
- `src/infrastructure/drivers/file_system.rs`: 95.0% (19/20)
- `src/infrastructure/drivers/shell.rs`: 100% (13/13)
- `src/infrastructure/test_support/mod.rs`: 92.1% (35/38)

### 中カバレッジ (50-90%)
- `src/infrastructure/test_support/mock_drivers/docker.rs`: 73.2% (30/41)
- `src/infrastructure/test_support/mock_drivers/shell.rs`: 81.3% (26/32)
- `src/infrastructure/test_support/mock_drivers/file_system.rs`: 66.7% (28/42)

### 低カバレッジ (50%未満)
- `src/infrastructure/drivers/logger.rs`: 42.9% (6/14)
- `src/main.rs`: 0% (0/17)

## 未カバー行の分析

### main.rs (優先度: 高)
- CLIのエントリーポイントが完全に未テスト
- 統合テストの追加が必要

### logger.rs (優先度: 中)
- ログレベル設定関連の処理が未テスト
- エラーハンドリングのパスが未カバー

### mock_drivers配下 (優先度: 低)
- エラーケースの処理が未テスト
- expectationの詳細な検証ロジック

## 改善計画

### フェーズ1: main.rsの統合テスト追加
1. CLIコマンドの基本動作テスト
2. 引数パースのテスト
3. エラーハンドリングのテスト

### フェーズ2: logger.rsのユニットテスト追加
1. 各ログレベルの動作確認
2. 環境変数によるレベル設定
3. エラー時のフォールバック動作

### フェーズ3: mock_driversの網羅性向上
1. エラーケースのテスト追加
2. 境界値テスト
3. expectationの詳細検証

## 目標カバレッジ
- 全体: 85%以上
- プロダクションコード: 90%以上
- テストサポートコード: 80%以上

## 実装優先順位
1. main.rsの統合テスト（影響度: 大）
2. logger.rsのユニットテスト（影響度: 中）
3. mock_driversの追加テスト（影響度: 小）