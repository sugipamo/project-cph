# 統一ドライバーパターン実装計画

## 概要
old_srcの`UnifiedDriver`パターンをRustに移植し、様々な操作（Docker、ファイル、シェル、Python）を統一的に扱えるシステムを構築します。

## 現状分析

### old_srcの統一ドライバー特徴
- リクエストベースの操作実行
- 適切なドライバーへの動的ルーティング
- 統一的なエラーハンドリング
- 遅延ロードによる効率化

### 現在のRustプロジェクト状況
- 個別のドライバーインターフェースは定義済み
- 統一的な操作実行メカニズムが不足
- リクエスト/レスポンスパターンが未実装

## 移植方針

### 1. リクエスト/レスポンス設計
```rust
pub enum OperationRequest {
    Docker(DockerRequest),
    File(FileRequest),
    Shell(ShellRequest),
    Python(PythonRequest),
}

pub enum OperationResult {
    Docker(DockerResult),
    File(FileResult),
    Shell(ShellResult),
    Python(PythonResult),
}
```

### 2. 統一ドライバーの実装
- トレイトオブジェクトによる動的ディスパッチ
- パターンマッチングによるルーティング
- 共通エラー型の定義

### 3. 非同期対応
- `async/await`による非同期実行
- `tokio`ランタイムの活用
- 並列実行のサポート

## 実装ステップ

### Phase 1: 基本構造
1. リクエスト/レスポンス型の定義
2. 統一ドライバートレイトの実装
3. 基本的なルーティング機能

### Phase 2: ドライバー統合
1. 既存ドライバーの統合
2. エラーハンドリングの統一
3. ロギングの一元化

### Phase 3: 高度な機能
1. リクエストのバッチ処理
2. トランザクション的な実行
3. リトライメカニズム

## 期待される効果
- 操作の一元的な管理
- 横断的な機能の実装が容易
- テストの簡素化
- 拡張性の向上

## 実装上の考慮事項
- 型安全性とのバランス
- パフォーマンスオーバーヘッドの最小化
- エラー情報の保持
- 非同期処理の適切な管理