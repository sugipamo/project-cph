# 統一ドライバーパターン拡張計画

## 概要
old_srcのUnifiedDriverパターンを参考に、現在のドライバー実装を統一的なインターフェースで管理する仕組みを構築する。

## 背景
- old_srcでは、複数のドライバー（Docker、Shell、File、Python）を統一インターフェースで管理
- リクエストタイプに基づく動的ルーティングにより、呼び出し側の複雑性を軽減
- 遅延初期化により、必要なドライバーのみを初期化

## 目的
1. 既存のドライバー（FileSystem、Shell、Logger）を統一的に管理
2. 新しいドライバー（Docker、Python等）の追加を容易にする
3. リクエスト・レスポンスパターンの導入により、処理の標準化

## 実装方針
### フェーズ1: 統一インターフェース定義
- UnifiedDriverトレイトの定義
- RequestとResponseの基本型定義
- ドライバー登録メカニズム

### フェーズ2: 既存ドライバーの移行
- FileSystemDriverの統一インターフェース対応
- ShellDriverの統一インターフェース対応
- LoggerDriverの統一インターフェース対応

### フェーズ3: 動的ルーティング実装
- リクエストタイプからドライバーへのマッピング
- 遅延初期化メカニズム
- エラーハンドリングの統一

## 技術的詳細
- トレイトオブジェクトによる動的ディスパッチ
- Enumベースのリクエストタイプ定義
- Result型による統一的なエラーハンドリング

## 期待される効果
- 新しいドライバーの追加が容易
- ドライバー間の処理の一貫性向上
- テストしやすい設計

## リスクと対策
- パフォーマンスオーバーヘッド
  - 対策: 頻繁に使用されるドライバーのキャッシング
- 型安全性の低下
  - 対策: ファントムタイプやジェネリクスの活用

## 参考
- old_src/infrastructure/drivers/unified/unified_driver.py
- 既存の統一ドライバーパターン実装計画（202506302002_00007）との統合