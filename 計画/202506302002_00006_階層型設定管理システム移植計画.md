# 階層型設定管理システム移植計画

## 概要
old_srcの`TypeSafeConfigNodeManager`をRustに移植し、型安全で高性能な設定管理システムを構築する計画です。

## 現状分析

### old_srcの設定管理システム特徴
- ConfigNodeによる階層的な設定構造
- 型安全な設定値の解決
- テンプレート文字列の展開
- 多層キャッシュによる高速化
- JSONベースの設定ファイル

### 現在のRustプロジェクトの課題
- 設定管理システムが未実装
- ハードコードされた値が散在
- 環境別設定の切り替えが困難

## 移植方針

### 1. Rustでの実装アプローチ
- `serde`による設定のシリアライズ/デシリアライズ
- `config`クレートの活用検討
- 型安全性を保証する設定構造体
- マクロによる設定アクセスの簡素化

### 2. 設定の階層構造
```rust
// システム設定 < 共有設定 < 言語設定 < 実行時設定
pub struct ConfigHierarchy {
    system: SystemConfig,
    shared: SharedConfig,
    language: HashMap<String, LanguageConfig>,
    runtime: RuntimeConfig,
}
```

### 3. テンプレート展開機能
- `handlebars`または`tera`の活用
- カスタムテンプレートエンジンの実装
- 変数の再帰的展開サポート

## 実装ステップ

### Phase 1: 基本設定構造
1. 設定構造体の定義
2. JSONファイルの読み込み
3. 基本的なマージロジック

### Phase 2: 型安全アクセス
1. ジェネリクスを使った型安全な取得
2. パス指定による階層アクセス
3. デフォルト値の処理

### Phase 3: 高度な機能
1. テンプレート文字列の展開
2. キャッシュシステムの実装
3. ホットリロード対応

## 期待される効果
- 設定の一元管理
- 環境別設定の容易な切り替え
- 型安全性によるバグの削減
- 高速な設定値アクセス

## 技術選定
- `serde`: JSON処理
- `config-rs`: 設定管理フレームワーク
- `cached`: キャッシュ実装
- `notify`: ファイル変更監視