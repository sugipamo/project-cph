refactor: エラー処理とファイル操作の改善 - エラーメッセージの構造を改善し、より明確な文脈を提供 - モジュール構造を整理し、重複コードを削除 - テストコードを簡素化 - ファイル操作関数のエラーハンドリングを統一
