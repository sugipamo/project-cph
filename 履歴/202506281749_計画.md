# 202506281749 実行計画

## 現状分析

### プロジェクト状況
- **ブランチ**: feature/dependency-reorganization
- **目的**: プロジェクト再生宣言に基づく段階的統合
- **全体テストカバレッジ**: 61%（目標: 70-80%）
- **テスト状況**: 818件中806件成功、12件スキップ

### 前回作業（202506281728）からの引き継ぎ事項
1. 低カバレッジモジュールへのテスト追加が必要
2. スキップされているテストの修正が必要
3. アプリケーション層のインフラ依存修正が残存（7ファイル）

## 実行計画

### 1. テストカバレッジの向上（優先度: 高）

#### 1.1 低カバレッジモジュールのテスト追加
- **contest_manager.py** (26%) - コンテスト管理機能のテスト強化
- **python_utils.py** (27%) - ユーティリティ関数のテスト追加
- **data_processors.py** (0%) - データ処理機能の基本テスト作成

#### 1.2 スキップテストの修正
- **test_execution_config.py** - regex_ops依存関係の解決
- **test_build_infrastructure.py** - 必要性の再評価と修正

### 2. CLAUDE.md違反の修正（優先度: 高）

#### 2.1 アプリケーション層のインフラ依存修正
残り7ファイルの修正：
- execution_history.py
- sqlite_manager.py
- fast_sqlite_manager.py
- mock_output_manager.py
- output_manager.py
- color_manager.py
- execution_results.py

### 3. Driver統合の準備（優先度: 中）

#### 3.1 統合影響調査
- 現在のDriver使用状況の把握
- 統合後のインターフェース設計
- 段階的移行計画の策定

### 4. 品質確認（優先度: 高）

#### 4.1 テスト実行と検証
- 全テストの実行（pytest）
- カバレッジレポートの生成
- CLAUDE.md違反チェックの実行

## 作業順序

1. **第1フェーズ（1-2時間）**
   - 低カバレッジモジュールのテスト追加
   - 特にdata_processors.py（0%）の基本テスト作成

2. **第2フェーズ（1-2時間）**
   - スキップテストの修正
   - regex_ops依存関係の解決

3. **第3フェーズ（2-3時間）**
   - アプリケーション層のインフラ依存修正
   - DIコンテナを通じた適切な依存性注入の実装

4. **第4フェーズ（1時間）**
   - 全体テストの実行
   - カバレッジ確認
   - 残タスクの整理

## 成功基準

- テストカバレッジ70%以上の達成
- 全テストの成功（スキップなし）
- CLAUDE.md違反の完全解消
- Driver統合に向けた明確な計画策定

## リスクと対策

### リスク1: テスト追加による新たな問題の発覚
- **対策**: 段階的にテストを追加し、都度動作確認を実施

### リスク2: インフラ依存修正による既存機能の破損
- **対策**: 修正前後でのテスト結果比較、慎重な動作確認

### リスク3: Driver統合の複雑性
- **対策**: 小規模な統合から開始し、段階的に拡大

## 備考

- 作業中は定期的にgit statusとテスト実行を行い、進捗を確認
- 各フェーズ完了時にコミットを作成（ユーザー指示時のみ）
- 問題発生時は速やかに残タスクとして記録