# CPH プロジェクト残タスク
## 作成日時: 2025-06-28 15:45

## 1. テストカバレッジ改善タスク

### 優先度: 高
現在のカバレッジ: 59% → 目標: 70%以上

#### カバレッジ0%のモジュール（優先対応）
1. **プレゼンテーション層**
   - `user_input_parser_integration.py` (0%)
   - 統合テストの作成が必要

2. **ユーティリティ**
   - `config_validation_utils.py` (0%)
   - `docker_path_ops.py` (0%)
   - `docker_utils.py` (0%)
   - `execution_validation_utils.py` (0%)
   - `mock_regex_provider.py` (0%)
   - `path_operations.py` (0%)
   - `regex_provider.py` (0%)
   - `retry_decorator.py` (0%)
   - `time_adapter.py` (0%)

#### 低カバレッジモジュール（要改善）
1. **インフラ層**
   - `fast_sqlite_manager.py` (23%)
   - `configuration_repository.py` (24%)
   - `unified_logger.py` (25%)

2. **ユーティリティ**
   - `python_utils.py` (27%)
   - `shell_utils.py` (47%)
   - `format_info.py` (52%)

## 2. アーキテクチャ改善タスク

### 優先度: 中

1. **ドライバー層の整理**
   - UnifiedDriverとPersistenceDriverの統合検討
   - 重複機能の削除
   - インターフェースの簡素化

2. **依存関係の最適化**
   - 深い依存関係階層の平坦化
   - 循環依存の完全な除去
   - 依存性注入の見直し

3. **リポジトリパターンの統一**
   - インターフェースの一貫性確保
   - 基底クラスの活用促進

## 3. CLAUDE.md準拠タスク

### 優先度: 高

1. **デフォルト値の除去**
   - 全モジュールでのデフォルト引数使用箇所の特定
   - 呼び出し元での明示的な値指定への変更
   - 設定ファイルでの管理への移行

2. **副作用の配置**
   - infrastructureレイヤー以外での副作用の特定
   - 適切なレイヤーへの移動
   - main.pyからの注入パターンの徹底

3. **長期的視点での実装**
   - 短期的解決の特定と改善
   - 拡張性を考慮した設計への変更

## 4. 機能実装タスク

### 優先度: 中

1. **CLIコマンドの完全実装**
   - `cph new`: 新規問題作成
   - `cph test`: テスト実行
   - `cph run`: 実行
   - `cph submit`: 提出機能

2. **ユーザー体験の改善**
   - エラーメッセージの日本語化と改善
   - ヘルプドキュメントの充実
   - プログレスバーの実装

3. **パフォーマンス最適化**
   - 設定読み込みの高速化（目標: <10μs）
   - キャッシュ機能の活用
   - 並列実行の最適化

## 5. ドキュメンテーションタスク

### 優先度: 低

1. **開発者向けドキュメント**
   - アーキテクチャ設計書の更新
   - API仕様書の作成
   - コントリビューションガイド

2. **ユーザー向けドキュメント**
   - クイックスタートガイド
   - よくある質問（FAQ）
   - トラブルシューティングガイド

## 6. 技術的負債の解消

### 継続的に対応

1. **コードの重複**
   - 同様の処理の共通化
   - ユーティリティ関数の整理

2. **エラーハンドリング**
   - 一貫したエラー処理パターン
   - カスタム例外の整理

3. **型安全性**
   - 型ヒントの完全性向上
   - mypy strictモードでのチェック

## 実施推奨順序

1. **即座に対応すべき項目**
   - カバレッジ0%の重要モジュールのテスト作成
   - CLAUDE.md準拠の基本的な違反の修正

2. **短期的に対応すべき項目**（1-2週間）
   - 低カバレッジモジュールのテスト追加
   - 主要なCLIコマンドの実装

3. **中期的に対応すべき項目**（1ヶ月）
   - アーキテクチャの改善
   - パフォーマンス最適化

4. **長期的に対応すべき項目**（3ヶ月）
   - 完全なCLAUDE.md準拠
   - ドキュメンテーションの充実
   - 技術的負債の完全解消

## 注意事項

- 各タスクは相互に依存関係があるため、実施順序には注意が必要
- テストカバレッジの改善は他の改善作業の基盤となるため優先度高
- CLAUDE.md準拠は品質と保守性に直結するため、継続的に意識する必要がある