# 2025年6月29日 残タスク

## 優先度：高
なし（すべて完了）

## 優先度：中

### 1. 副作用の移動（36箇所）
**概要**: infrastructure層以外で副作用を持つコードを移動する必要がある

**技術的課題**:
- src_check/processors/rules/side_effect_checker.pyの実行に問題あり
- モジュールインポートパスの修正が必要
- 修正方法: `from models.check_result` → `from src_check.models.check_result`

**対応方法**:
1. src_check内のインポートパスを修正
2. side_effect_checker.pyを実行して違反箇所を特定
3. 各違反箇所をinfrastructure層に移動
4. main.pyから依存性注入パターンで提供

## 優先度：低

### 1. テストカバレッジの向上

**完了（今回の作業で改善）**:
- ✅ `src/operations/requests/composite_request.py` (60% → 97%)
- ✅ `src/operations/results/base_result.py` (60% → 100%)
- ✅ `src/infrastructure/drivers/docker/docker_driver.py` (61% → 99%)

**60-70%のモジュール（残り7個）**:
- `src/infrastructure/os_provider.py` (62%)
- `src/presentation/docker_command_builder.py` (62%)
- `src/operations/requests/request_factory.py` (66%)
- `src/utils/sys_provider.py` (67%)
- `src/domain/services/workflow_execution_service.py` (68%)
- `src/domain/workflow_logger_adapter.py` (69%)
- `src/infrastructure/drivers/generic/unified_driver.py` (69%)

**70-75%のモジュール（追加分）**:
- `src/infrastructure/drivers/generic/persistence_driver.py` (70%)
- `src/operations/interfaces/infrastructure_interfaces.py` (70%)
- `src/operations/interfaces/utility_interfaces.py` (71%)
- `src/domain/workflow.py` (72%)
- `src/infrastructure/drivers/generic/base_driver.py` (72%)
- `src/logging/unified_logger.py` (72%)
- `src/operations/interfaces/execution_interfaces.py` (72%)
- `src/data/state/state_repository.py` (73%)
- `src/operations/results/check_result.py` (73%)
- `src/domain/step.py` (74%)
- `src/infrastructure/module_info.py` (74%)
- `src/operations/error_codes.py` (75%)

### 2. アーキテクチャの簡素化
**現状**: 150ファイル、75ディレクトリ
**課題**: 過度に複雑な構造
**対応**: 責務の統合と不要な抽象化の除去

## 実装時の注意事項

1. **CLAUDE.md厳守**
   - デフォルト値の使用禁止
   - フォールバック処理の禁止
   - 中長期視点での実装
   - 副作用はinfrastructure層のみ

2. **テスト実行**
   - 各変更後は必ず全テストを実行
   - カバレッジの低下を防ぐ

3. **品質管理ツールの活用**
   - src_check配下のチェッカーを定期的に実行
   - 新たな違反を作らない

## 今回の作業結果

- 総合テストカバレッジ: 88%（良好）
- テスト総数: 1814個
- 全テスト通過率: 100%
- 新規追加テストファイル: `/tests/operations/results/test_base_result.py` (26個のテスト)